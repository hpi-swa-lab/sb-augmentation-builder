/* esm.sh - esbuild bundle(@lezer/highlight@1.2.0) es2022 production */
import{NodeProp as V}from"./common.mjs";var G=0,y=class s{constructor(t,a,i){this.set=t,this.base=a,this.modified=i,this.id=G++}static define(t){if(t?.base)throw new Error("Can not derive from a modified tag");let a=new s([],null,[]);if(a.set.push(a),t)for(let i of t.set)a.set.push(i);return a}static defineModifier(){let t=new E;return a=>a.modified.indexOf(t)>-1?a:E.get(a.base||a,a.modified.concat(t).sort((i,n)=>i.id-n.id))}},L=0,E=class s{constructor(){this.instances=[],this.id=L++}static get(t,a){if(!a.length)return t;let i=a[0].instances.find(o=>o.base==t&&Q(a,o.modified));if(i)return i;let n=[],r=new y(n,t,a);for(let o of a)o.instances.push(r);let h=U(a);for(let o of t.set)if(!o.modified.length)for(let p of h)n.push(s.get(o,p));return r}};function Q(s,t){return s.length==t.length&&s.every((a,i)=>a==t[i])}function U(s){let t=[[]];for(let a=0;a<s.length;a++)for(let i=0,n=t.length;i<n;i++)t.push(t[i].concat(s[a]));return t.sort((a,i)=>i.length-a.length)}function _(s){let t=Object.create(null);for(let a in s){let i=s[a];Array.isArray(i)||(i=[i]);for(let n of a.split(" "))if(n){let r=[],h=2,o=n;for(let f=0;;){if(o=="..."&&f>0&&f+3==n.length){h=1;break}let c=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(o);if(!c)throw new RangeError("Invalid path: "+n);if(r.push(c[0]=="*"?"":c[0][0]=='"'?JSON.parse(c[0]):c[0]),f+=c[0].length,f==n.length)break;let d=n[f++];if(f==n.length&&d=="!"){h=0;break}if(d!="/")throw new RangeError("Invalid path: "+n);o=n.slice(f)}let p=r.length-1,g=r[p];if(!g)throw new RangeError("Invalid path: "+n);let b=new M(i,h,p>0?r.slice(0,p):null);t[g]=b.sort(t[g])}}return z.add(t)}var z=new V,M=class{constructor(t,a,i,n){this.tags=t,this.mode=a,this.context=i,this.next=n}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}};M.empty=new M([],2,null);function W(s,t){let a=Object.create(null);for(let r of s)if(!Array.isArray(r.tag))a[r.tag.id]=r.class;else for(let h of r.tag)a[h.id]=r.class;let{scope:i,all:n=null}=t||{};return{style:r=>{let h=n;for(let o of r)for(let p of o.set){let g=a[p.id];if(g){h=h?h+" "+g:g;break}}return h},scope:i}}function X(s,t){let a=null;for(let i of s){let n=i.style(t);n&&(a=a?a+" "+n:n)}return a}function Y(s,t,a,i=0,n=s.length){let r=new P(i,Array.isArray(t)?t:[t],a);r.highlightRange(s.cursor(),i,n,"",r.highlighters),r.flush(n)}function tt(s,t,a,i,n,r=0,h=s.length){let o=r;function p(g,b){if(!(g<=o)){for(let f=s.slice(o,g),c=0;;){let d=f.indexOf(`
`,c),R=d<0?f.length:d;if(R>c&&i(f.slice(c,R),b),d<0)break;n(),c=d+1}o=g}}Y(t,a,(g,b,f)=>{p(g,""),p(b,f)},r,h),p(h,"")}var P=class{constructor(t,a,i){this.at=t,this.highlighters=a,this.span=i,this.class=""}startSpan(t,a){a!=this.class&&(this.flush(t),t>this.at&&(this.at=t),this.class=a)}flush(t){t>this.at&&this.class&&this.span(this.at,t,this.class)}highlightRange(t,a,i,n,r){let{type:h,from:o,to:p}=t;if(o>=i||p<=a)return;h.isTop&&(r=this.highlighters.filter(d=>!d.scope||d.scope(h)));let g=n,b=Z(t)||M.empty,f=X(r,b.tags);if(f&&(g&&(g+=" "),g+=f,b.mode==1&&(n+=(n?" ":"")+f)),this.startSpan(Math.max(a,o),g),b.opaque)return;let c=t.tree&&t.tree.prop(V.mounted);if(c&&c.overlay){let d=t.node.enter(c.overlay[0].from+o,1),R=this.highlighters.filter(v=>!v.scope||v.scope(c.tree.type)),D=t.firstChild();for(let v=0,O=o;;v++){let S=v<c.overlay.length?c.overlay[v]:null,K=S?S.from+o:p,H=Math.max(a,O),T=Math.min(i,K);if(H<T&&D)for(;t.from<T&&(this.highlightRange(t,H,T,n,r),this.startSpan(Math.min(T,t.to),g),!(t.to>=K||!t.nextSibling())););if(!S||K>i)break;O=S.to+o,O>a&&(this.highlightRange(d.cursor(),Math.max(a,S.from+o),Math.min(i,O),"",R),this.startSpan(Math.min(i,O),g))}D&&t.parent()}else if(t.firstChild()){c&&(n="");do if(!(t.to<=a)){if(t.from>=i)break;this.highlightRange(t,a,i,n,r),this.startSpan(Math.min(i,t.to),g)}while(t.nextSibling());t.parent()}}};function Z(s){let t=s.type.prop(z);for(;t&&t.context&&!s.matchContext(t.context);)t=t.next;return t||null}var e=y.define,C=e(),N=e(),F=e(N),J=e(N),x=e(),I=e(x),j=e(x),k=e(),w=e(k),m=e(),u=e(),B=e(),A=e(B),q=e(),l={comment:C,lineComment:e(C),blockComment:e(C),docComment:e(C),name:N,variableName:e(N),typeName:F,tagName:e(F),propertyName:J,attributeName:e(J),className:e(N),labelName:e(N),namespace:e(N),macroName:e(N),literal:x,string:I,docString:e(I),character:e(I),attributeValue:e(I),number:j,integer:e(j),float:e(j),bool:e(x),regexp:e(x),escape:e(x),color:e(x),url:e(x),keyword:m,self:e(m),null:e(m),atom:e(m),unit:e(m),modifier:e(m),operatorKeyword:e(m),controlKeyword:e(m),definitionKeyword:e(m),moduleKeyword:e(m),operator:u,derefOperator:e(u),arithmeticOperator:e(u),logicOperator:e(u),bitwiseOperator:e(u),compareOperator:e(u),updateOperator:e(u),definitionOperator:e(u),typeOperator:e(u),controlOperator:e(u),punctuation:B,separator:e(B),bracket:A,angleBracket:e(A),squareBracket:e(A),paren:e(A),brace:e(A),content:k,heading:w,heading1:e(w),heading2:e(w),heading3:e(w),heading4:e(w),heading5:e(w),heading6:e(w),contentSeparator:e(k),list:e(k),quote:e(k),emphasis:e(k),strong:e(k),link:e(k),monospace:e(k),strikethrough:e(k),inserted:e(),deleted:e(),changed:e(),invalid:e(),meta:q,documentMeta:e(q),annotation:e(q),processingInstruction:e(q),definition:y.defineModifier(),constant:y.defineModifier(),function:y.defineModifier(),standard:y.defineModifier(),local:y.defineModifier(),special:y.defineModifier()},et=W([{tag:l.link,class:"tok-link"},{tag:l.heading,class:"tok-heading"},{tag:l.emphasis,class:"tok-emphasis"},{tag:l.strong,class:"tok-strong"},{tag:l.keyword,class:"tok-keyword"},{tag:l.atom,class:"tok-atom"},{tag:l.bool,class:"tok-bool"},{tag:l.url,class:"tok-url"},{tag:l.labelName,class:"tok-labelName"},{tag:l.inserted,class:"tok-inserted"},{tag:l.deleted,class:"tok-deleted"},{tag:l.literal,class:"tok-literal"},{tag:l.string,class:"tok-string"},{tag:l.number,class:"tok-number"},{tag:[l.regexp,l.escape,l.special(l.string)],class:"tok-string2"},{tag:l.variableName,class:"tok-variableName"},{tag:l.local(l.variableName),class:"tok-variableName tok-local"},{tag:l.definition(l.variableName),class:"tok-variableName tok-definition"},{tag:l.special(l.variableName),class:"tok-variableName2"},{tag:l.definition(l.propertyName),class:"tok-propertyName tok-definition"},{tag:l.typeName,class:"tok-typeName"},{tag:l.namespace,class:"tok-namespace"},{tag:l.className,class:"tok-className"},{tag:l.macroName,class:"tok-macroName"},{tag:l.propertyName,class:"tok-propertyName"},{tag:l.operator,class:"tok-operator"},{tag:l.comment,class:"tok-comment"},{tag:l.meta,class:"tok-meta"},{tag:l.invalid,class:"tok-invalid"},{tag:l.punctuation,class:"tok-punctuation"}]);export{y as Tag,et as classHighlighter,Z as getStyleTags,tt as highlightCode,Y as highlightTree,_ as styleTags,W as tagHighlighter,l as tags};
